schema_info:
  title: ChEBI (Chemical Entities of Biological Interest)
  description: |
    ChEBI is an ontology database containing 217,000+ chemical entities of biological interest. 
    Main entities include small molecules, atoms, ions, functional groups, and macromolecules with 
    hierarchical classification via rdfs:subClassOf. Provides molecular data (formula, mass, InChI, 
    SMILES), biological roles via RO_0000087, chemical relationships (conjugate acids/bases, tautomers, 
    enantiomers), and cross-references to 20+ databases (KEGG, DrugBank, PubChem, HMDB, CAS).
  endpoint: https://rdfportal.org/ebi/sparql
  base_uri: http://purl.obolibrary.org/obo/CHEBI_
  graphs:
    - http://rdf.ebi.ac.uk/dataset/chebi
  kw_search_tools:
    - OLS4:searchClasses
  version:
    mie_version: "1.3"
    mie_created: "2025-01-16"
    data_version: Release 2025
    update_frequency: Monthly
  license:
    data_license: Creative Commons Attribution 4.0
    license_url: https://creativecommons.org/licenses/by/4.0/
  access:
    rate_limiting: 100 queries/min
    max_query_timeout: 60 seconds
    backend: Virtuoso (supports bif:contains for full-text search)

shape_expressions: |
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX chebi_data: <http://purl.obolibrary.org/obo/chebi/>
  PREFIX chebi_rel: <http://purl.obolibrary.org/obo/chebi#>
  PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
  PREFIX obo: <http://purl.obolibrary.org/obo/>
  
  <ChemicalEntityShape> {
    a [ owl:Class ] ;
    rdfs:label xsd:string ;
    rdfs:subClassOf IRI * ;
    obo:IAO_0000115 xsd:string ? ;
    oboInOwl:id xsd:string ;
    oboInOwl:hasOBONamespace xsd:string ;
    oboInOwl:hasDbXref xsd:string * ;
    oboInOwl:hasRelatedSynonym xsd:string * ;
    oboInOwl:hasExactSynonym xsd:string * ;
    chebi_data:formula xsd:string ? ;
    chebi_data:mass xsd:string ? ;
    chebi_data:charge xsd:string ? ;
    chebi_data:smiles xsd:string ? ;
    chebi_data:inchi xsd:string ? ;
    chebi_data:inchikey xsd:string ? ;
    owl:deprecated xsd:boolean ?
  }
  
  <ChemicalRelationshipShape> {
    rdfs:subClassOf [ a owl:Restriction ] ;
    owl:onProperty [ 
      chebi_rel:has_role |
      chebi_rel:is_conjugate_acid_of |
      chebi_rel:is_conjugate_base_of |
      chebi_rel:is_tautomer_of |
      chebi_rel:is_enantiomer_of |
      <http://purl.obolibrary.org/obo/RO_0000087>
    ]
  }

sample_rdf_entries:
  - title: Small Molecule - Water
    description: Complete entry with molecular structure, synonyms, and cross-references.
    rdf: |
      obo:CHEBI_15377 a owl:Class ;
        rdfs:label "water" ;
        rdfs:subClassOf obo:CHEBI_33693 ;
        obo:IAO_0000115 "An oxygen hydride consisting of an oxygen atom covalently bonded to two hydrogen atoms" ;
        oboInOwl:id "CHEBI:15377" ;
        oboInOwl:hasRelatedSynonym "H2O", "HOH" ;
        oboInOwl:hasDbXref "CAS:7732-18-5", "KEGG:C00001" ;
        chebi:formula "H2O" ;
        chebi:mass "18.01530" ;
        chebi:smiles "[H]O[H]" ;
        chebi:inchikey "XLYOFNOQVPJJNP-UHFFFAOYSA-N" .
  - title: Amino Acid - L-proline
    description: Proteinogenic amino acid with complete structural data.
    rdf: |
      obo:CHEBI_17203 a owl:Class ;
        rdfs:label "L-proline" ;
        rdfs:subClassOf obo:CHEBI_26271, obo:CHEBI_83813 ;
        oboInOwl:hasDbXref "CAS:147-85-3", "KEGG:C00148", "DrugBank:DB00172" ;
        chebi:formula "C5H9NO2" ;
        chebi:mass "115.13050" ;
        chebi:smiles "OC(=O)[C@@H]1CCCN1" ;
        chebi:inchikey "ONIBWKKTOPOVIA-BYPYZUCNSA-N" .
  - title: Drug with Chemical Relationships
    description: Ciprofloxacin showing conjugate base and tautomer relationships via OWL restrictions.
    rdf: |
      obo:CHEBI_100241 a owl:Class ;
        rdfs:label "ciprofloxacin" ;
        rdfs:subClassOf [
          a owl:Restriction ;
          owl:onProperty chebi:is_conjugate_base_of ;
          owl:someValuesFrom obo:CHEBI_192486
        ] ;
        rdfs:subClassOf [
          a owl:Restriction ;
          owl:onProperty chebi:is_tautomer_of ;
          owl:someValuesFrom obo:CHEBI_192484
        ] .
  - title: Element - Phosphorus
    description: Atom entry with classification as nonmetal.
    rdf: |
      obo:CHEBI_28659 a owl:Class ;
        rdfs:label "phosphorus atom" ;
        rdfs:subClassOf obo:CHEBI_25585, obo:CHEBI_33300 ;
        oboInOwl:hasDbXref "CAS:7723-14-0", "KEGG:C06262" ;
        chebi:formula "P" ;
        chebi:mass "30.97376" ;
        chebi:smiles "[P]" ;
        chebi:inchikey "OAICVXFJPJFONN-UHFFFAOYSA-N" .
  - title: Lipid - Triolein
    description: Triglyceride with complex molecular structure.
    rdf: |
      obo:CHEBI_53753 a owl:Class ;
        rdfs:label "triolein" ;
        rdfs:subClassOf obo:CHEBI_17855 ;
        oboInOwl:hasDbXref "CAS:122-32-7", "HMDB:HMDB0005453" ;
        chebi:formula "C57H104O6" ;
        chebi:mass "885.43210" ;
        chebi:smiles "CCCCCCCC\\C=C/CCCCCCCC(=O)OCC(COC(=O)CCCCCCC\\C=C/CCCCCCCC)OC(=O)CCCCCCC\\C=C/CCCCCCCC" .

sparql_query_examples:
  - title: Search by Keyword with bif:contains
    description: Find chemical entities using full-text search with relevance scoring.
    question: Find all entities related to glucose.
    complexity: basic
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      
      SELECT ?entity ?label ?sc
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label .
        ?label bif:contains "'glucose'" option (score ?sc) .
      }
      ORDER BY DESC(?sc)
      LIMIT 20
  - title: Get Molecular Properties
    description: Retrieve formula, mass, and structure identifiers for a compound.
    question: What are molecular properties of aspirin?
    complexity: basic
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      
      SELECT ?label ?formula ?mass ?smiles ?inchikey
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        obo:CHEBI_15365 rdfs:label ?label .
        OPTIONAL { obo:CHEBI_15365 chebi:formula ?formula }
        OPTIONAL { obo:CHEBI_15365 chebi:mass ?mass }
        OPTIONAL { obo:CHEBI_15365 chebi:smiles ?smiles }
        OPTIONAL { obo:CHEBI_15365 chebi:inchikey ?inchikey }
      }
  - title: Search by Biological Role
    description: Find chemicals with specific biological roles using RO_0000087.
    question: Find all antibiotics.
    complexity: intermediate
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      
      SELECT ?entity ?label ?roleLabel
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label .
        ?label bif:contains "'antibiotic'" option (score ?sc) .
        ?entity rdfs:subClassOf ?restriction .
        ?restriction owl:onProperty <http://purl.obolibrary.org/obo/RO_0000087> ;
                     owl:someValuesFrom ?role .
        ?role rdfs:label ?roleLabel .
      }
      ORDER BY DESC(?sc)
      LIMIT 20
  - title: Navigate Hierarchy
    description: Traverse ontology hierarchy to find parent classes.
    question: What are parent classes of L-proline?
    complexity: intermediate
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT ?parent ?parentLabel
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        obo:CHEBI_17203 rdfs:subClassOf ?parent .
        FILTER(STRSTARTS(STR(?parent), "http://purl.obolibrary.org/obo/CHEBI_"))
        ?parent rdfs:label ?parentLabel .
      }
  - title: Find Chemical Relationships
    description: Query conjugate acid/base relationships via OWL restrictions.
    question: Find chemicals and their conjugate bases.
    complexity: intermediate
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi#>
      
      SELECT ?acid ?acidLabel ?base ?baseLabel
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?acid rdfs:subClassOf ?restriction .
        ?restriction owl:onProperty chebi:is_conjugate_acid_of ;
                     owl:someValuesFrom ?base .
        ?acid rdfs:label ?acidLabel .
        ?base rdfs:label ?baseLabel .
      }
      LIMIT 20
  - title: Complex Formula Search with Aggregation
    description: Find compounds by formula pattern and count cross-references.
    question: Find carbon-oxygen compounds with database coverage.
    complexity: advanced
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?entity ?label ?formula (COUNT(?xref) as ?xrefCount)
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label ;
                chebi:formula ?formula .
        FILTER(CONTAINS(?formula, "C") && CONTAINS(?formula, "O"))
        OPTIONAL { ?entity oboInOwl:hasDbXref ?xref }
      }
      GROUP BY ?entity ?label ?formula
      HAVING (COUNT(?xref) > 5)
      ORDER BY DESC(?xrefCount)
      LIMIT 20
  - title: Boolean Search with Exclusion
    description: Complex keyword search excluding specific terms.
    question: Find amyloid-related compounds excluding precursor.
    complexity: advanced
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT ?entity ?label ?definition ?sc
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label .
        ?label bif:contains "('amyloid' AND NOT 'precursor')" option (score ?sc) .
        OPTIONAL { ?entity obo:IAO_0000115 ?definition }
      }
      ORDER BY DESC(?sc)
      LIMIT 20

cross_database_queries:
  shared_endpoint: ebi
  co_located_databases:
    - chembl
    - reactome
    - ensembl
    - amrportal
  examples:
    - title: Integrate ChEBI with ChEMBL Drug Data
      description: |
        Link ChEBI chemical entities to ChEMBL drug molecules to enrich ChEBI compounds 
        with bioactivity data, target information, and clinical development phase. 
        ChEMBL molecules reference ChEBI via skos:exactMatch, enabling seamless integration.
      databases_used:
        - chembl
        - chebi
      complexity: intermediate
      sparql: |
        PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
        
        SELECT DISTINCT ?moleculeLabel ?chebiLabel ?formula ?mass ?developmentPhase
        WHERE {
          GRAPH <http://rdf.ebi.ac.uk/dataset/chembl> {
            ?molecule a cco:SmallMolecule ;
                      rdfs:label ?moleculeLabel ;
                      skos:exactMatch ?chebiId ;
                      cco:highestDevelopmentPhase ?developmentPhase .
            FILTER(?developmentPhase >= 3)
          }
          GRAPH <http://rdf.ebi.ac.uk/dataset/chebi> {
            ?chebiId a owl:Class ;
                     rdfs:label ?chebiLabel .
            OPTIONAL { ?chebiId chebi:formula ?formula }
            OPTIONAL { ?chebiId chebi:mass ?mass }
          }
        }
        ORDER BY DESC(?developmentPhase)
        LIMIT 50
      notes: |
        - Query uses graph URIs from ChEMBL and ChEBI MIE files
        - ChEMBL links via skos:exactMatch property (from ChEMBL MIE shape expressions)
        - Filter on cco:highestDevelopmentPhase for clinical trial drugs (phases 3-4)
        - Performance: ~2-3 seconds for 50 results
        - Use case: Identify marketed or late-stage drugs with ChEBI chemical ontology data
        - Referenced ChEMBL MIE file for correct graph URI and property patterns
    - title: Link ChEBI Metabolites to Reactome Pathways
      description: |
        Connect ChEBI small molecules to biological pathways in Reactome to understand 
        metabolite roles in biochemical processes. Reactome references ChEBI via UnificationXref 
        with bp:db="ChEBI" and bp:id containing "CHEBI:" prefix.
      databases_used:
        - reactome
        - chebi
      complexity: intermediate
      sparql: |
        PREFIX bp: <http://www.biopax.org/release/biopax-level3.owl#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
        PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
        
        SELECT DISTINCT ?reactomeName ?chebiLabel ?formula ?mass ?pathway ?pathwayName
        WHERE {
          GRAPH <http://rdf.ebi.ac.uk/dataset/reactome> {
            ?molecule a bp:SmallMolecule ;
                      bp:displayName ?reactomeName ;
                      bp:entityReference/bp:xref ?xref .
            ?xref a bp:UnificationXref ;
                  bp:db "ChEBI"^^xsd:string ;
                  bp:id ?fullChebiId .
            FILTER(STRSTARTS(?fullChebiId, "CHEBI:"))
            BIND(SUBSTR(?fullChebiId, 7) AS ?chebiNum)
            ?pathway a bp:Pathway ;
                     bp:displayName ?pathwayName ;
                     bp:pathwayComponent+/bp:left|bp:right ?molecule .
            FILTER(CONTAINS(?pathwayName, "metabolism"))
          }
          BIND(IRI(CONCAT("http://purl.obolibrary.org/obo/CHEBI_", ?chebiNum)) AS ?chebiUri)
          GRAPH <http://rdf.ebi.ac.uk/dataset/chebi> {
            ?chebiUri a owl:Class ;
                      rdfs:label ?chebiLabel .
            OPTIONAL { ?chebiUri chebi:formula ?formula }
            OPTIONAL { ?chebiUri chebi:mass ?mass }
          }
        }
        LIMIT 50
      notes: |
        - Query uses graph URIs from Reactome and ChEBI MIE files
        - Reactome ChEBI IDs include "CHEBI:" prefix, requiring SUBSTR extraction
        - Uses BIND to construct ChEBI URI from numeric ID (pattern from Reactome MIE file)
        - Property path bp:pathwayComponent+ traverses pathway hierarchy (from Reactome shape expressions)
        - CRITICAL: Use ^^xsd:string for bp:db comparison (from Reactome anti-patterns)
        - Performance: ~3-5 seconds, property paths are moderately expensive
        - Use case: Map metabolites to metabolic pathways for systems biology analysis
        - Referenced Reactome MIE file for correct xref pattern and anti-patterns
    - title: Multi-Database Drug-Target-Pathway Integration
      description: |
        Comprehensive query linking ChEMBL drugs targeting proteins to Reactome pathways 
        containing those targets, with ChEBI chemical structure data. Demonstrates complex 
        three-way integration across co-located databases.
      databases_used:
        - chembl
        - chebi
        - reactome
      complexity: advanced
      sparql: |
        PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
        PREFIX bp: <http://www.biopax.org/release/biopax-level3.owl#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
        PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
        
        SELECT DISTINCT ?drugName ?targetName ?pathwayName ?chebiLabel ?formula
        WHERE {
          GRAPH <http://rdf.ebi.ac.uk/dataset/chembl> {
            ?molecule a cco:SmallMolecule ;
                      rdfs:label ?drugName ;
                      skos:exactMatch ?chebiId ;
                      cco:hasActivity/cco:hasAssay/cco:hasTarget ?target .
            ?target a cco:SingleProtein ;
                    rdfs:label ?targetName ;
                    cco:hasTargetComponent/skos:exactMatch ?uniprotId .
            FILTER(STRSTARTS(STR(?uniprotId), "http://purl.uniprot.org/uniprot/"))
          }
          GRAPH <http://rdf.ebi.ac.uk/dataset/reactome> {
            ?protein a bp:Protein ;
                     bp:entityReference/bp:xref ?protXref .
            ?protXref a bp:UnificationXref ;
                      bp:db "UniProt"^^xsd:string ;
                      bp:id ?uniprotIdStr .
            ?pathway a bp:Pathway ;
                     bp:displayName ?pathwayName ;
                     bp:pathwayComponent*/bp:left|bp:right ?protein .
            FILTER(CONTAINS(STR(?uniprotId), ?uniprotIdStr))
          }
          GRAPH <http://rdf.ebi.ac.uk/dataset/chebi> {
            ?chebiId a owl:Class ;
                     rdfs:label ?chebiLabel .
            OPTIONAL { ?chebiId chebi:formula ?formula }
          }
        }
        LIMIT 20
      notes: |
        - Query integrates three databases using graph URIs from all MIE files
        - ChEMBL→ChEBI: skos:exactMatch (from ChEMBL shape expressions)
        - ChEMBL→UniProt: target component exact match (from ChEMBL architectural notes)
        - Reactome→UniProt: bp:xref with bp:db filter (from Reactome cross-references)
        - UniProt ID matching requires CONTAINS due to different URI formats
        - Property paths used: cco:hasActivity/cco:hasAssay/cco:hasTarget and bp:pathwayComponent*
        - Performance: 5-8 seconds, complex three-way join with property paths
        - Use case: Drug target validation and mechanism of action research
        - All patterns verified against ChEMBL, Reactome, and ChEBI MIE files

cross_references:
  - pattern: oboInOwl:hasDbXref
    description: |
      Cross-references to external databases as literal strings with prefix:id format.
    databases:
      chemical:
        - CAS
        - Beilstein
        - Reaxys
        - Gmelin
      biological:
        - KEGG
        - HMDB
        - DrugBank
        - MetaCyc
      structure:
        - PubChem
        - ChEMBL
        - LIPID_MAPS_instance
      knowledge:
        - Wikipedia
        - PMID
        - Patent
    sparql: |
      SELECT ?entity ?label ?xref
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label ;
                oboInOwl:hasDbXref ?xref .
        FILTER(STRSTARTS(?xref, "KEGG:") || STRSTARTS(?xref, "DrugBank:"))
      }
      LIMIT 100

architectural_notes:
  search_strategies:
    - Use OLS4:searchClasses tool for keyword-based entity search
    - Use bif:contains within SPARQL for advanced full-text search with boolean operators
  schema_design:
    - OWL ontology with owl:Class for chemical entities
    - Hierarchical classification via rdfs:subClassOf
    - Chemical relationships as OWL restrictions
    - Biological roles via RO_0000087 through restrictions
    - CRITICAL - ChEBI uses TWO namespaces - data properties use chebi/ and relationship properties use chebi#
  performance:
    - Use bif:contains for keyword searches (faster than FILTER CONTAINS)
    - Filter by CHEBI_ URI prefix early to exclude non-entity classes
    - Use LIMIT for large result sets
    - Cross-reference queries slow - filter by database prefix when possible
  data_integration:
    - Cross-references as literal strings requiring parsing
    - InChI/InChIKey for standardized structure matching
    - SMILES for substructure searching
    - ChEMBL integration via skos:exactMatch (see cross_database_queries)
    - Reactome integration via bp:xref with ChEBI IDs (see cross_database_queries)
  data_quality:
    - Not all entities have molecular properties
    - Abstract classes lack molecular data
    - Deprecated entities marked with owl:deprecated

data_statistics:
  total_chemical_entities: 217368
  entities_with_formulas: 187110
  coverage:
    with_label: ~91%
    with_formula: ~86%
    with_inchi: ~81%
    with_smiles: ~85%
    with_mass: ~86%
  cardinality:
    avg_dbxrefs_per_entity: 1.9
    avg_synonyms_per_entity: 1.2
    avg_parents_per_entity: 1.7
  performance_characteristics:
    - bif:contains searches typically <2s
    - Hierarchy traversal may timeout with deep recursion
    - Restriction-based queries moderately expensive
    - Cross-database queries 2-5s depending on complexity
  data_quality_notes:
    - Manual curation ensures high accuracy
    - Regular monthly updates
    - Cross-database links well-maintained with ChEMBL and Reactome

anti_patterns:
  - title: FILTER CONTAINS vs bif:contains
    problem: FILTER CONTAINS is slower and lacks relevance scoring.
    wrong_sparql: |
      SELECT ?entity ?label
      WHERE {
        ?entity rdfs:label ?label .
        FILTER(CONTAINS(LCASE(?label), "aspirin"))
      }
    correct_sparql: |
      SELECT ?entity ?label ?sc
      WHERE {
        ?entity rdfs:label ?label .
        ?label bif:contains "'aspirin'" option (score ?sc) .
      }
      ORDER BY DESC(?sc)
    explanation: bif:contains uses full-text indexing and provides relevance scores.
  - title: Wrong ChEBI Property Namespace
    problem: ChEBI uses TWO different namespaces - data properties (/) vs relationship properties (#).
    wrong_sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi#>
      SELECT ?entity ?formula
      WHERE {
        ?entity chebi:formula ?formula .
      }
    correct_sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      SELECT ?entity ?formula
      WHERE {
        ?entity chebi:formula ?formula .
      }
    explanation: Data properties (formula, mass, smiles) use chebi/ while relationship properties (is_conjugate_acid_of) use chebi#.
  - title: Accessing Roles Without Restrictions
    problem: Roles encoded as OWL restrictions, not direct properties.
    wrong_sparql: |
      SELECT ?entity ?role
      WHERE {
        ?entity chebi:has_role ?role .
      }
    correct_sparql: |
      SELECT ?entity ?role
      WHERE {
        ?entity rdfs:subClassOf ?restriction .
        ?restriction owl:onProperty <http://purl.obolibrary.org/obo/RO_0000087> ;
                     owl:someValuesFrom ?role .
      }
    explanation: ChEBI encodes has_role through OWL restrictions.
  - title: Not Filtering Non-ChEBI Entities
    problem: Database contains ontology metadata and other classes.
    wrong_sparql: |
      SELECT ?entity ?label
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label .
      }
    correct_sparql: |
      SELECT ?entity ?label
      WHERE {
        ?entity a owl:Class .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
        ?entity rdfs:label ?label .
      }
    explanation: Filter by CHEBI_ URI prefix for chemical entities only.

common_errors:
  - error: 503 Service Temporarily Unavailable
    causes:
      - Server overload or complex query timeout
      - Too many concurrent requests
    solutions:
      - Retry after brief delay
      - Simplify query or reduce LIMIT
      - Split into smaller queries
  - error: Empty results for molecular properties
    causes:
      - Using wrong namespace (chebi# instead of chebi/ for data properties)
      - Querying abstract chemical classes
      - Entity deprecated or incomplete
    solutions:
      - Use correct namespace - http://purl.obolibrary.org/obo/chebi/ for data properties
      - Use chebi# namespace only for relationship properties
      - Check owl:deprecated status
      - Verify entity is concrete molecular entity
      - Use OPTIONAL for properties
  - error: Chemical relationship queries fail
    causes:
      - Using wrong namespace (chebi/ instead of chebi# for relationship properties)
      - Using property directly instead of via restrictions
    solutions:
      - Use chebi# namespace for relationship properties
      - Use OWL restriction pattern
      - Use OPTIONAL to check existence
