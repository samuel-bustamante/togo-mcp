schema_info:
  title: DDBJ (DNA Data Bank of Japan)
  description: |
    DDBJ RDF provides nucleotide sequence data from the International Nucleotide Sequence Database Collaboration (INSDC). Contains genome and sequence entries with rich genomic annotations including genes, coding sequences (CDS), and various RNA types (tRNA, rRNA, ncRNA, tmRNA). Features extensive organism metadata with taxonomic classification via NCBI Taxonomy, functional annotations, and protein translations linked to NCBI Protein. Cross-referenced to BioProject and BioSample for experimental context. Uses FALDO for precise genomic coordinates, Sequence Ontology (SO) for semantic feature typing, and BFO/RO ontologies for biological relationships. Primarily contains prokaryotic genomes but also includes viral and some eukaryotic sequences. All features are linked to their parent entries and organisms, enabling comprehensive queries from organism level down to individual genes and their products.
  endpoint: https://rdfportal.org/ddbj/sparql
  base_uri: http://identifiers.org/insdc/
  graphs:
    - http://rdfportal.org/dataset/ddbj
    - http://rdfportal.org/ontology/nucleotide
    - http://rdfportal.org/ontology/so
    - http://rdfportal.org/ontology/faldo
  kw_search_tools:
    - sparql
  version:
    mie_version: "2.0"
    mie_created: "2025-01-18"
    data_version: "DDBJ Release (continuous updates)"
    update_frequency: "Daily"
  license:
    data_license: "CC0 1.0 Universal (CC0 1.0) Public Domain Dedication"
    license_url: "https://creativecommons.org/publicdomain/zero/1.0/"
  access:
    rate_limiting: "No strict rate limit, please use responsibly"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso (supports bif:contains)"

shape_expressions: |
  PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
  PREFIX faldo: <http://biohackathon.org/resource/faldo#>
  PREFIX bfo: <http://purl.obolibrary.org/obo/BFO_>
  PREFIX ro: <http://purl.obolibrary.org/obo/RO_>
  PREFIX sio: <http://semanticscience.org/resource/SIO_>
  PREFIX so: <http://purl.obolibrary.org/obo/SO_>
  
  <EntryShape> {
    a [ nuc:Entry ] ;
    rdfs:label xsd:string ;
    dcterms:identifier xsd:string ;
    nuc:definition xsd:string ;
    nuc:organism xsd:string ;
    nuc:taxonomy xsd:string ;
    nuc:division IRI ;
    nuc:sequence IRI ;
    nuc:sequence_version xsd:string ;
    nuc:sequence_date xsd:date ;
    nuc:dblink IRI* ;
    nuc:reference IRI* ;
    nuc:comment xsd:string ? ;
    nuc:source xsd:string ?
  }
  
  <GeneShape> {
    a [ nuc:Gene ] ;
    rdfs:subClassOf IRI+ ;
    rdfs:label xsd:string ;
    dcterms:identifier xsd:string ;
    skos:prefLabel xsd:string ;
    nuc:locus_tag xsd:string ;
    nuc:gene xsd:string ? ;
    nuc:location xsd:string ;
    faldo:location @<RegionShape> ;
    bfo:0000050 IRI ;
    bfo:0000051 IRI* ;
    ro:0002162 IRI
  }
  
  <CodingSequenceShape> {
    a [ nuc:Coding_Sequence ] ;
    rdfs:subClassOf IRI+ ;
    nuc:locus_tag xsd:string ;
    nuc:product xsd:string ;
    nuc:translation xsd:string ;
    nuc:codon_start xsd:integer ;
    nuc:transl_table xsd:integer ;
    faldo:location @<RegionShape> ;
    rdfs:seeAlso IRI ;
    sio:SIO_010081 IRI ;
    bfo:0000050 IRI ;
    ro:0002162 IRI
  }
  
  <TransferRNAShape> {
    a [ nuc:Transfer_RNA ] ;
    rdfs:subClassOf IRI+ ;
    faldo:location @<RegionShape> ;
    nuc:product xsd:string ? ;
    bfo:0000050 IRI ;
    ro:0002162 IRI
  }
  
  <RibosomalRNAShape> {
    a [ nuc:Ribosomal_RNA ] ;
    rdfs:subClassOf IRI+ ;
    faldo:location @<RegionShape> ;
    nuc:product xsd:string ? ;
    bfo:0000050 IRI ;
    ro:0002162 IRI
  }
  
  <NonCodingRNAShape> {
    a [ nuc:Non_Coding_RNA ] ;
    rdfs:subClassOf IRI+ ;
    faldo:location @<RegionShape> ;
    nuc:product xsd:string ? ;
    bfo:0000050 IRI ;
    ro:0002162 IRI
  }
  
  <RepeatRegionShape> {
    a [ nuc:Repeat_Region ] ;
    rdfs:subClassOf IRI+ ;
    faldo:location @<RegionShape> ;
    nuc:note xsd:string ? ;
    bfo:0000050 IRI ;
    ro:0002162 IRI
  }
  
  <MiscellaneousFeatureShape> {
    a [ nuc:Miscellaneous_Feature ] ;
    rdfs:subClassOf IRI+ ;
    faldo:location @<RegionShape> ;
    nuc:note xsd:string ? ;
    bfo:0000050 IRI ;
    ro:0002162 IRI
  }
  
  <MobileElementShape> {
    a [ nuc:Mobile_Element ] ;
    rdfs:subClassOf IRI+ ;
    faldo:location @<RegionShape> ;
    nuc:mobile_element_type xsd:string ? ;
    bfo:0000050 IRI ;
    ro:0002162 IRI
  }
  
  <SourceShape> {
    a [ nuc:Source ] ;
    rdfs:subClassOf IRI ;
    nuc:organism xsd:string ;
    nuc:mol_type xsd:string ;
    faldo:location @<RegionShape> ;
    rdfs:seeAlso IRI ;
    bfo:0000050 IRI ;
    ro:0002162 IRI
  }
  
  <RegionShape> {
    a [ faldo:Region ] ;
    faldo:begin @<PositionShape> ;
    faldo:end @<PositionShape>
  }
  
  <PositionShape> {
    a [ faldo:ExactPosition ] ;
    faldo:position xsd:integer ;
    faldo:reference IRI
  }

sample_rdf_entries:
  - title: "Entry with BioProject/BioSample Links"
    description: "Genome entry with organism metadata and external database links to experimental context."
    rdf: |
      <http://identifiers.org/insdc/CP036276.1>
        a nuc:Entry ;
        rdfs:label "Symmachiella dynata strain Mal52 chromosome, complete genome." ;
        dcterms:identifier "CP036276.1" ;
        nuc:organism "Symmachiella dynata" ;
        nuc:dblink <http://identifiers.org/biosample/SAMN10954015> ;
        nuc:dblink <http://identifiers.org/bioproject/PRJNA485700> .
  
  - title: "Gene with FALDO Location"
    description: "Gene feature with locus tag, gene symbol, and genomic coordinates using FALDO."
    rdf: |
      <http://identifiers.org/insdc/CP036276.1#feature:1001623-1002915:1:gene.47722>
        a nuc:Gene ;
        rdfs:subClassOf so:0000704 ;
        nuc:locus_tag "Mal52_08030" ;
        nuc:gene "clpX" ;
        faldo:location <http://identifiers.org/insdc/CP036276.1#region:1001623-1002915:1> ;
        bfo:0000050 <http://identifiers.org/insdc/CP036276.1#sequence> ;
        ro:0002162 <http://identifiers.org/taxonomy/2527995> .
  
  - title: "CDS with Protein Link and Translation"
    description: "Coding sequence with product annotation, protein translation, and NCBI Protein cross-reference."
    rdf: |
      <http://identifiers.org/insdc/CP036276.1#feature:1001623-1002915:1:CDS.47054>
        a nuc:Coding_Sequence ;
        nuc:locus_tag "Mal52_08030" ;
        nuc:product "ATP-dependent Clp protease ATP-binding subunit ClpX" ;
        nuc:translation "MPSGNDVTSGSRGATGKK..." ;
        nuc:codon_start 1 ;
        nuc:transl_table 11 ;
        rdfs:seeAlso <http://identifiers.org/ncbiprotein/QDU42347.1> ;
        sio:SIO_010081 <http://identifiers.org/insdc/CP036276.1#feature:1001623-1002915:1:gene.47722> .
  
  - title: "Non-coding RNA Feature"
    description: "ncRNA feature with product annotation showing regulatory RNA elements."
    rdf: |
      <http://identifiers.org/insdc/CP040814.1#feature:1849218-1849588:1:ncRNA.979>
        a nuc:Non_Coding_RNA ;
        rdfs:subClassOf so:0000655 ;
        nuc:product "RNase P RNA component class A" ;
        faldo:location <http://identifiers.org/insdc/CP040814.1#region:1849218-1849588:1> ;
        bfo:0000050 <http://identifiers.org/insdc/CP040814.1#sequence> ;
        ro:0002162 <http://identifiers.org/taxonomy/573> .
  
  - title: "Source with Taxonomy Cross-reference"
    description: "Source feature linking organism information to NCBI Taxonomy for classification."
    rdf: |
      <http://identifiers.org/insdc/AB023775.1#feature:103-136:1:source.1>
        a nuc:Source ;
        nuc:organism "Lactobacillus phage phiFSW" ;
        nuc:mol_type "genomic DNA" ;
        rdfs:seeAlso <http://identifiers.org/taxonomy/91019> ;
        ro:0002162 <http://identifiers.org/taxonomy/1582> .

sparql_query_examples:
  - title: "Search Entries by Organism with bif:contains"
    description: "Find entries using full-text search with relevance scoring on organism names."
    question: "What entries exist for Escherichia coli?"
    complexity: basic
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?entry ?organism ?relevance
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?entry a nuc:Entry ;
               nuc:organism ?organism .
        ?organism bif:contains "'escherichia' AND 'coli'" option (score ?relevance) .
      }
      ORDER BY DESC(?relevance)
      LIMIT 10
  
  - title: "Get Gene Annotations by Locus Tag"
    description: "Retrieve gene and product information for a specific locus tag identifier."
    question: "What are the annotations for locus Mal52_08030?"
    complexity: basic
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?gene ?gene_symbol ?product
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?gene a nuc:Gene ;
              nuc:locus_tag "Mal52_08030" .
        OPTIONAL { ?gene nuc:gene ?gene_symbol }
        OPTIONAL {
          ?cds nuc:locus_tag "Mal52_08030" ;
               nuc:product ?product .
        }
      }
  
  - title: "Retrieve Genes with Genomic Coordinates"
    description: "Query genes with FALDO coordinates from a specific entry, showing positional information."
    question: "What are the gene coordinates in entry CP036276.1?"
    complexity: intermediate
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX faldo: <http://biohackathon.org/resource/faldo#>
      
      SELECT ?locus_tag ?gene_name ?start ?end
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?gene a nuc:Gene ;
              nuc:locus_tag ?locus_tag ;
              faldo:location ?region .
        OPTIONAL { ?gene nuc:gene ?gene_name }
        ?region faldo:begin/faldo:position ?start ;
                faldo:end/faldo:position ?end .
        FILTER(CONTAINS(STR(?gene), "CP036276.1"))
      }
      LIMIT 10
  
  - title: "Search Products by Keywords Within Entry"
    description: "Find protease or peptidase genes within a specific entry using product description filtering."
    question: "Find protease or peptidase genes in CP036276.1."
    complexity: intermediate
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?locus_tag ?product
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?cds a nuc:Coding_Sequence ;
             nuc:locus_tag ?locus_tag ;
             nuc:product ?product .
        FILTER(CONTAINS(STR(?cds), "CP036276.1"))
        FILTER(CONTAINS(LCASE(?product), "protease") || CONTAINS(LCASE(?product), "peptidase"))
      }
      LIMIT 50
  
  - title: "Retrieve All RNA Feature Types"
    description: "Find different types of RNA features (tRNA, rRNA, ncRNA) using UNION query pattern."
    question: "What RNA features exist in the database?"
    complexity: intermediate
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?rna_type ?product
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        {
          ?rna a nuc:Transfer_RNA ; nuc:product ?product .
          BIND("tRNA" AS ?rna_type)
        }
        UNION
        {
          ?rna a nuc:Ribosomal_RNA ; nuc:product ?product .
          BIND("rRNA" AS ?rna_type)
        }
        UNION
        {
          ?rna a nuc:Non_Coding_RNA ; nuc:product ?product .
          BIND("ncRNA" AS ?rna_type)
        }
      }
      LIMIT 20
  
  - title: "Gene-CDS-Protein Integration Query"
    description: "Complex query joining genes to coding sequences and protein IDs, showing complete annotation chain."
    question: "Get complete gene-to-protein annotations for entry CP036276.1."
    complexity: advanced
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX sio: <http://semanticscience.org/resource/>
      
      SELECT ?locus_tag ?gene_name ?product ?protein_id
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?gene a nuc:Gene ;
              nuc:locus_tag ?locus_tag .
        OPTIONAL { ?gene nuc:gene ?gene_name }
        ?cds sio:SIO_010081 ?gene ;
             nuc:product ?product ;
             rdfs:seeAlso ?protein_id .
        FILTER(CONTAINS(STR(?protein_id), "ncbiprotein"))
        FILTER(CONTAINS(STR(?gene), "CP036276.1"))
      }
      LIMIT 100
  
  - title: "Multi-Feature Query with Taxonomic Context"
    description: "Advanced query retrieving multiple feature types with organism classification and BioProject links."
    question: "Get genes, RNAs, and organism metadata for entries with BioProject links."
    complexity: advanced
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX ro: <http://purl.obolibrary.org/obo/RO_>
      
      SELECT ?entry ?organism ?taxon ?locus_tag ?feature_type
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?entry a nuc:Entry ;
               nuc:organism ?organism ;
               nuc:dblink ?bioproject .
        FILTER(CONTAINS(STR(?bioproject), "bioproject"))
        ?feature bfo:0000050 ?entry ;
                 nuc:locus_tag ?locus_tag ;
                 ro:0002162 ?taxon .
        BIND(
          IF(?feature_type = nuc:Gene, "gene",
          IF(?feature_type = nuc:Transfer_RNA, "tRNA",
          IF(?feature_type = nuc:Ribosomal_RNA, "rRNA", "other"))) 
          AS ?feature_type
        )
        FILTER(?feature_type IN ("gene", "tRNA", "rRNA"))
      }
      LIMIT 50

cross_references:
  - pattern: "nuc:dblink"
    description: |
      Entry-level links to BioProject and BioSample provide experimental context and metadata about the sequencing project and biological samples.
    databases:
      project_metadata:
        - "BioProject: Sequencing project organization"
        - "BioSample: Specimen and sample metadata"
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?entry ?bioproject ?biosample
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?entry a nuc:Entry ;
               nuc:dblink ?bioproject ;
               nuc:dblink ?biosample .
        FILTER(CONTAINS(STR(?bioproject), "bioproject"))
        FILTER(CONTAINS(STR(?biosample), "biosample"))
      }
      LIMIT 10
  
  - pattern: "rdfs:seeAlso"
    description: |
      Feature-level cross-references to external databases including NCBI Protein for translations, FASTA for sequences, and NCBI Taxonomy for organism classification.
    databases:
      protein:
        - "NCBI Protein: RefSeq protein sequences"
      taxonomy:
        - "NCBI Taxonomy: Taxonomic classification"
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?feature ?external_db
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?feature rdfs:seeAlso ?external_db .
        FILTER(CONTAINS(STR(?external_db), "ncbiprotein") || CONTAINS(STR(?external_db), "taxonomy"))
      }
      LIMIT 50
  
  - pattern: "ro:0002162 (in taxon)"
    description: |
      Relation Ontology property linking all features to their taxonomic context via NCBI Taxonomy identifiers.
    databases:
      taxonomy:
        - "NCBI Taxonomy: Full taxonomic hierarchy"
    sparql: |
      PREFIX ro: <http://purl.obolibrary.org/obo/RO_>
      
      SELECT ?feature ?taxon
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?feature ro:0002162 ?taxon .
        FILTER(CONTAINS(STR(?taxon), "taxonomy"))
      }
      LIMIT 50
  
  - pattern: "rdfs:subClassOf"
    description: |
      Semantic feature classification using Sequence Ontology (SO) terms for standardized feature typing.
    databases:
      ontology:
        - "Sequence Ontology: Standardized genomic feature types"
    sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?feature ?so_class
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?feature rdfs:subClassOf ?so_class .
        FILTER(CONTAINS(STR(?so_class), "obo/SO_"))
      }
      LIMIT 50

architectural_notes:
  search_strategies:
    - "Use bif:contains for organism name searches at entry level - fast with relevance scoring"
    - "Within entries, use FILTER CONTAINS for product/description searches on feature properties"
    - "Always filter by entry accession ID before complex queries or feature joins"
    - "See sparql_query_examples for complete bif:contains syntax and patterns"
  schema_design:
    - "Entry-centric hierarchy with features linked via BFO_0000050 (part of) and BFO_0000051 (has part)"
    - "FALDO ontology provides precise genomic coordinates for all features"
    - "Sequence Ontology (SO) terms enable semantic feature typing via rdfs:subClassOf"
    - "Gene-CDS relationships via sio:SIO_010081 (is transcribed into) - note uppercase 'SIO' required"
    - "All features linked to organisms via ro:0002162 (in taxon) enabling taxonomic filtering"
    - "Rich annotation with 50+ feature types beyond core Gene/CDS/RNA types"
  performance:
    - "CRITICAL: Always filter by entry accession before complex queries to prevent timeouts"
    - "Entry-specific queries by accession ID are fast and recommended"
    - "bif:contains works best for organism searches at entry level, not for feature products"
    - "FALDO coordinate queries require entry filtering first"
    - "Avoid aggregation (COUNT, GROUP BY) without entry filtering - use sampling instead"
    - "Gene-CDS joins via sio:SIO_010081 are optimized when scoped to single entries"
  data_integration:
    - "Uses identifiers.org URIs for standardized cross-database linking"
    - "BioProject/BioSample provide experimental context for sequencing projects"
    - "NCBI Protein links enable connection to RefSeq and GenBank protein records"
    - "NCBI Taxonomy integration provides organism classification and phylogenetic context"
  data_quality:
    - "Locus tags are more reliable and complete than gene symbols for identification"
    - "~60% of genes have gene symbols, >99% have locus tags"
    - "CDS features have >95% coverage for product descriptions and translations"
    - "Database primarily contains prokaryotic genomes (bacteria, archaea) plus some viral sequences"
    - "All features have FALDO coordinates (>99% coverage)"

data_statistics:
  total_entries: "Large collection (exact count requires sampling due to timeout on aggregation)"
  coverage:
    entries_with_organism: ">99%"
    genes_with_locus_tag: ">99%"
    genes_with_gene_symbol: "~60%"
    cds_with_product: ">95%"
    cds_with_translation: ">95%"
    features_with_faldo: ">99%"
    entries_with_bioproject: "~85%"
    entries_with_biosample: "~85%"
  cardinality:
    genes_per_entry: "10-5000 (varies by genome size)"
    cds_per_entry: "8-4800 (typically similar to gene count)"
    trna_per_entry: "40-100 (bacterial genomes)"
    rrna_per_entry: "3-9 (bacterial genomes)"
    ncrna_per_entry: "5-50 (varies by organism)"
  performance_characteristics:
    - "Entry-specific queries by accession are fast (<1 second)"
    - "bif:contains for organism search at entry level is fast (<2 seconds)"
    - "Product searches require entry filtering to avoid timeouts"
    - "FALDO coordinate queries require entry scope first"
    - "Cross-entry aggregation requires sampling approach"
    - "Gene-CDS-Protein joins work well within single entries"
  data_quality_notes:
    - "Primarily prokaryotic data with high annotation completeness"
    - "Locus tags are primary identifiers (more reliable than gene symbols)"
    - "Most entries include BioProject and BioSample links for metadata"

anti_patterns:
  - title: "Cartesian Product from Unfiltered Feature Joins"
    problem: "Joining features without entry filtering creates massive Cartesian products causing timeouts."
    wrong_sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX sio: <http://semanticscience.org/resource/>
      
      SELECT ?gene ?cds
      WHERE {
        ?gene a nuc:Gene .
        ?cds a nuc:Coding_Sequence .
        ?cds sio:SIO_010081 ?gene .
      }
    correct_sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX sio: <http://semanticscience.org/resource/>
      
      SELECT ?gene ?cds
      WHERE {
        ?gene a nuc:Gene .
        ?cds sio:SIO_010081 ?gene .
        FILTER(CONTAINS(STR(?gene), "CP036276.1"))
      }
      LIMIT 100
    explanation: "Always filter by entry accession first to constrain the result set before performing joins."
  
  - title: "Aggregation Without Entry Filtering"
    problem: "Using COUNT or GROUP BY without entry filter causes query timeout."
    wrong_sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT (COUNT(*) as ?count)
      WHERE {
        ?entry a nuc:Entry
      }
    correct_sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?entry
      WHERE {
        ?entry a nuc:Entry
      }
      LIMIT 100
    explanation: "Replace aggregation with sampling using LIMIT. For statistics, sample entries and extrapolate."
  
  - title: "FALDO Queries Without Entry Filter"
    problem: "Coordinate queries without entry ID constraint cause timeout due to scanning all features."
    wrong_sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX faldo: <http://biohackathon.org/resource/faldo#>
      
      SELECT ?gene ?start
      WHERE {
        ?gene a nuc:Gene ;
              faldo:location/faldo:begin/faldo:position ?start .
        FILTER(?start >= 1000000)
      }
    correct_sparql: |
      PREFIX nuc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX faldo: <http://biohackathon.org/resource/faldo#>
      
      SELECT ?gene ?start
      WHERE {
        ?gene a nuc:Gene ;
              faldo:location/faldo:begin/faldo:position ?start .
        FILTER(CONTAINS(STR(?gene), "CP036276.1"))
        FILTER(?start >= 1000000)
      }
      LIMIT 50
    explanation: "Always filter by entry URI before any FALDO coordinate queries to constrain search space."

common_errors:
  - error: "Query Timeout"
    causes:
      - "Cartesian product from unfiltered joins between feature types"
      - "Aggregation (COUNT, GROUP BY) without entry filtering"
      - "FALDO coordinate queries without entry scope"
      - "Product searches using bif:contains without entry filter"
      - "Using bif:contains on feature-level properties instead of entry-level"
    solutions:
      - "Add entry filter: FILTER(CONTAINS(STR(?variable), 'ENTRY_ACCESSION'))"
      - "Use FILTER CONTAINS (not bif:contains) for product searches within entries"
      - "Use bif:contains only for organism searches at entry level"
      - "Sample with LIMIT instead of COUNT for statistics"
      - "Always scope queries to specific entries before joins"
    example_fix: |
      # Wrong - timeout risk:
      SELECT ?gene ?cds WHERE {
        ?gene a nuc:Gene .
        ?cds sio:SIO_010081 ?gene .
      }
      
      # Correct - scoped to entry:
      SELECT ?gene ?cds WHERE {
        ?gene a nuc:Gene .
        ?cds sio:SIO_010081 ?gene .
        FILTER(CONTAINS(STR(?gene), "CP036276.1"))
      } LIMIT 100
  
  - error: "Wrong SIO Property (Case-Sensitive)"
    causes:
      - "Using lowercase sio:010081 instead of correct sio:SIO_010081"
      - "SIO namespace properties are case-sensitive in DDBJ"
    solutions:
      - "Always use uppercase: sio:SIO_010081 for gene-CDS relationships"
      - "Verify SIO property names match exactly with uppercase 'SIO'"
    example_fix: |
      # Wrong - will not match:
      ?cds sio:010081 ?gene .
      
      # Correct - uppercase SIO:
      ?cds sio:SIO_010081 ?gene .
  
  - error: "Empty Results or Missing Data"
    causes:
      - "Missing FROM clause pointing to correct graph"
      - "Treating optional properties (like nuc:gene symbol) as required"
      - "Wrong bif:contains syntax with incorrect quoting"
      - "Filtering for feature types that don't exist in queried entries"
    solutions:
      - "Always include: FROM <http://rdfportal.org/dataset/ddbj>"
      - "Use OPTIONAL for properties like nuc:gene (gene symbols)"
      - "Use single quotes inside double quotes for bif:contains: bif:contains \"'keyword'\""
      - "Sample entries first to verify feature types exist before complex queries"
    example_fix: |
      # Wrong - missing optional and FROM:
      SELECT ?gene ?symbol WHERE {
        ?gene a nuc:Gene ;
              nuc:locus_tag "ABC_001" ;
              nuc:gene ?symbol .
      }
      
      # Correct - optional gene symbol with FROM:
      SELECT ?gene ?symbol
      FROM <http://rdfportal.org/dataset/ddbj>
      WHERE {
        ?gene a nuc:Gene ;
              nuc:locus_tag "ABC_001" .
        OPTIONAL { ?gene nuc:gene ?symbol }
      }
